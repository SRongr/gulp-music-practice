var controlManger;window.$=window.Zepto,window.root=window.player;var listControl,songList,audioControl=new root.audioControl,$body=$(document.body),index=0,$play=$(".play_btn"),$like=$("like_btn"),$div=$("div")[0],process=root.process;function bindEvent(){$body.on("click",".like_btn",function(){$(this).toggleClass("liking")}),$body.on("click",".play_btn",function(){"play"===audioControl.status?(audioControl.pause(),root.process.stop()):(audioControl.play(),root.process.start()),$(this).toggleClass("pause")}),$body.on("play:change",function(o,n){n&&(index=n),root.render(songList[index]),audioControl.getAudio(songList[index].audio),listControl.renderActive(),process.renderTime(songList[index].duration),"pause"===audioControl.status?(void 0,$(".play_btn").trigger("click")):audioControl.play(),process.upDate(0)}),$body.on("click",".pre_btn",function(){index=controlManger.pre(),void 0,$body.trigger("play:change")}),$body.on("click",".next_btn",function(){index=controlManger.next(),$body.trigger("play:change")}),$body.on("click",".list_btn",function(){$body.find(".list").removeClass("hidden")}),$body.on("click",".close",function(){$body.find(".list").addClass("hidden")}),$body.on("click","li",function(){var o=$(this).attr("liIndex");$body.trigger("play:change",o)})}function bindTouch(){var o=$(".slider"),n=$body.find(".pro_wrapper").offset(),e=n.left,i=n.width;void 0,o.on("touchstart",function(o){process.stop()}).on("touchmove",function(o){var n=(o.changedTouches[0].clientX-e)/i;1<n?n=1:n<0&&(n=0),process.upDate(n)}).on("touchend",function(o){var n=(o.changedTouches[0].clientX-e)/i;1<n?n=1:n<0&&(n=0);var t=n*songList[controlManger.getIndex(index)].duration;audioControl.playTo(t),process.start(n)})}function getData(o){$.ajax({type:"GET",url:o,success:function(o){songList=o,len=songList.length,controlManger=new root.controlManger,listControl=new root.listControl,audioControl.getAudio(o[index].audio),bindEvent(),bindTouch(),listControl.renderList(),process.renderTime(songList[index].duration),root.render(o[index])},error:function(){void 0}})}getData("../data/data.json");